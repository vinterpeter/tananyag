<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tanulókártyák - Spaced Repetition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .deck-info {
            color: #888;
            font-size: 0.9rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00d9ff;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
        }

        .stat-item.new .stat-value { color: #00d9ff; }
        .stat-item.learning .stat-value { color: #ffa500; }
        .stat-item.review .stat-value { color: #00ff88; }
        .stat-item.mastered .stat-value { color: #9b59b6; }

        /* Card Container */
        .card-container {
            perspective: 1000px;
            margin-bottom: 30px;
        }

        .flashcard {
            width: 100%;
            height: 300px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
        }

        .card-front {
            background: linear-gradient(145deg, #2a2a4a, #1e1e3a);
            border: 2px solid rgba(0, 217, 255, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3),
                        inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .card-back {
            background: linear-gradient(145deg, #1e3a2a, #1a2e1e);
            border: 2px solid rgba(0, 255, 136, 0.3);
            transform: rotateY(180deg);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3),
                        inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .card-content {
            font-size: 1.4rem;
            line-height: 1.6;
        }

        .card-image {
            max-width: 100%;
            max-height: 150px;
            border-radius: 10px;
            margin-bottom: 15px;
            object-fit: contain;
        }

        .card-hint {
            position: absolute;
            bottom: 20px;
            font-size: 0.8rem;
            color: #666;
        }

        .card-tags {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 5px;
        }

        .tag {
            background: rgba(255,255,255,0.1);
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.7rem;
            color: #888;
        }

        .card-number {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 0.8rem;
            color: #666;
        }

        /* Rating Buttons */
        .rating-buttons {
            display: none;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .rating-buttons.visible {
            display: flex;
        }

        .rating-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #fff;
        }

        .rating-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .rating-btn.again {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
        }

        .rating-btn.hard {
            background: linear-gradient(145deg, #e67e22, #d35400);
        }

        .rating-btn.good {
            background: linear-gradient(145deg, #27ae60, #1e8449);
        }

        .rating-btn.easy {
            background: linear-gradient(145deg, #3498db, #2980b9);
        }

        .rating-btn .next-review {
            display: block;
            font-size: 0.7rem;
            opacity: 0.8;
            margin-top: 3px;
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Control Buttons */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .control-btn {
            padding: 12px 30px;
            border: 2px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: #fff;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.4);
        }

        .control-btn.primary {
            background: linear-gradient(145deg, #00d9ff, #0099cc);
            border: none;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-state h2 {
            color: #00ff88;
            margin-bottom: 15px;
        }

        .empty-state p {
            color: #888;
            margin-bottom: 30px;
        }

        /* Session Complete */
        .session-complete {
            text-align: center;
            padding: 40px;
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
        }

        .session-complete h2 {
            color: #00ff88;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .session-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
        }

        .session-stat {
            text-align: center;
        }

        .session-stat-value {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .session-stat-label {
            color: #888;
            font-size: 0.9rem;
        }

        /* Settings Panel */
        .settings-panel {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
        }

        .settings-panel h3 {
            margin-bottom: 15px;
            color: #00d9ff;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: #ccc;
        }

        .setting-value {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .setting-input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            padding: 8px 12px;
            border-radius: 8px;
            width: 80px;
            text-align: center;
        }

        /* Keyboard Shortcuts */
        .shortcuts {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
        }

        .shortcuts h4 {
            color: #888;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .shortcut-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .shortcut {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85rem;
        }

        .key {
            background: rgba(255,255,255,0.1);
            padding: 4px 10px;
            border-radius: 5px;
            font-family: monospace;
            color: #00d9ff;
        }

        /* Streak indicator */
        .streak-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
            color: #ffa500;
        }

        .streak-fire {
            font-size: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .stats-bar {
                flex-wrap: wrap;
                gap: 15px;
            }

            .stat-item {
                flex: 1 1 40%;
            }

            .rating-buttons {
                flex-wrap: wrap;
            }

            .rating-btn {
                flex: 1 1 45%;
            }

            .flashcard {
                height: 250px;
            }

            .card-content {
                font-size: 1.1rem;
            }
        }

        /* Loading animation */
        .loading {
            text-align: center;
            padding: 60px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #00d9ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* File input styling */
        .file-input-container {
            text-align: center;
            margin: 20px 0;
        }

        .file-input-label {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(145deg, #00d9ff, #0099cc);
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 217, 255, 0.3);
        }

        #fileInput {
            display: none;
        }

        .load-custom {
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Tanulókártyák</h1>
            <p class="deck-info" id="deckInfo">Spaced Repetition System</p>
        </header>

        <div id="app">
            <div class="loading">
                <div class="spinner"></div>
                <p>Kártyák betöltése...</p>
            </div>
        </div>

        <div class="load-custom">
            <input type="file" id="fileInput" accept=".json" style="display:none">
            <button class="control-btn" onclick="document.getElementById('fileInput').click()">
                Saját JSON betöltése
            </button>
        </div>

        <div class="shortcuts">
            <h4>Billentyűparancsok</h4>
            <div class="shortcut-list">
                <div class="shortcut"><span class="key">Space</span> Kártya megfordítása</div>
                <div class="shortcut"><span class="key">1</span> Újra</div>
                <div class="shortcut"><span class="key">2</span> Nehéz</div>
                <div class="shortcut"><span class="key">3</span> Jó</div>
                <div class="shortcut"><span class="key">4</span> Könnyű</div>
                <div class="shortcut"><span class="key">R</span> Visszaállítás</div>
            </div>
        </div>
    </div>

    <script>
        // Default embedded cards - Katonai tereptan vizsgafelkészítő
        const DEFAULT_DATA = {
            "deck": {
                "name": "Katonai tereptan - Vizsgafelkészítő",
                "description": "A Magyar Honvédség katonai tereptan tananyaga: tereptani alapismeretek, térképészeti alapismeretek, tájékozódási alapismeretek, tájolók, GPS"
            },
            "cards": [
                {"id": 1, "front": "Mi a terep definíciója?", "back": "A Föld felszínének egy része, amelyen a katonai tevékenységek végbemennek. Hatással van a harc megvívására, a harctevékenység körülményeire és lehetőségeire. Befolyásolja a személyi állomány harcképességét, a haditechnikai eszközök alkalmazását.", "tags": ["tereptan", "alapfogalom"]},
                {"id": 2, "front": "Mik a terep alkotóelemei?", "back": "1. Domborzat (a terep váza)\n2. Vizek (óceánok, tengerek, tavak, vízfolyások, mocsarak)\n3. Növényzet (természetes és mesterséges)\n4. Talaj (a földkéreg felső laza rétege)\n5. Közlekedési hálózat\n6. Települések (és egyéb létesítmények)", "tags": ["tereptan", "alkotóelemek"]},
                {"id": 3, "front": "Mik a terep harcászati jellemzői?", "back": "1. Járhatóság (a terep leküzdhetősége)\n2. Fedezőképesség (fedezék és rejtés)\n3. Megfigyelési és tűzvezetési lehetőségek", "tags": ["tereptan", "harcászat"]},
                {"id": 4, "front": "Mi a különbség a fedezék és a rejtés között?", "back": "Fedezék: ellenséges lőfegyverek tüze elleni védelem (pl. lövészárok, harckocsi mélyedés).\nRejtés: felderítés elleni védelem, láthatóság csökkentése (pl. álcázás, növényzet takarása).", "tags": ["tereptan", "harcászat"]},
                {"id": 5, "front": "Hogyan osztályozzuk a terepet járhatóság szerint?", "back": "1. Járható: tereptárgyak nem korlátozzák a mozgást\n2. Nehezen járható: helyenként akadályozza\n3. Járhatatlan: tereptárgyak végig korlátozzák a mozgást\n\nMegkülönböztetjük körkörös és egyirányú járhatóságot is.", "tags": ["tereptan", "járhatóság"]},
                {"id": 6, "front": "Mi a síkvidék katonai szempontból?", "back": "Viszonylagos magasságkülönbségek: 0-30 m. Jellemző a jó járhatóság (különösen a nagy sík felületeken), a rálátás és tűzvezetés előnye, de a rejtőzési lehetőségek korlátozottak.", "tags": ["tereptan", "terepfajta"]},
                {"id": 7, "front": "Mi a dombvidék katonai szempontból?", "back": "Viszonylagos magasságkülönbségek: 30-200 m. Kedvezőbb rejtőzési és fedezéki lehetőségek mint síkvidéken, változatosabb terepviszonyok, megnehezített megfigyelés.", "tags": ["tereptan", "terepfajta"]},
                {"id": 8, "front": "Mi a hegyvidék katonai szempontból?", "back": "Viszonylagos magasságkülönbségek: 200 m felett. Jelentősen korlátozza a mozgást, a megfigyelést és a tűzvezetést. Magaslatok birtoklása kulcsfontosságú. Korlátozott járhatóság, fontos szorosok és hágók.", "tags": ["tereptan", "terepfajta"]},
                {"id": 9, "front": "Mik a síkvidéki tájtípusok?", "back": "1. Síkvidéki típus (igazi síkság)\n2. Homokbuckás síkvidék\n3. Hullámos síkvidék", "tags": ["tereptan", "tájtípus"]},
                {"id": 10, "front": "Mik a dombvidéki és hegyvidéki tájtípusok?", "back": "Dombvidék:\n1. Dombvidéki tájtípus\n2. Árkolt dombvidék\n\nHegyvidék:\n1. Hegyvidéki tájtípus\n2. Magashegységi tájtípus", "tags": ["tereptan", "tájtípus"]},
                {"id": 11, "front": "Hol helyezkedik el Magyarország az UTM rendszerben?", "back": "Magyarország területe az UTM rendszer 33-as és 34-es zónájába esik. A zónahatár nagyjából a 18° keleti hosszúság mentén húzódik.", "tags": ["térképészet", "UTM"]},
                {"id": 12, "front": "Mi az MGRS (Military Grid Reference System)?", "back": "Katonai keresőhálózati rendszer, amely az UTM zónákra épül. Felépítése: zónaszám + zónabetű + 100 km-es négyzet azonosító (2 betű) + koordináták (keleti és északi érték).", "tags": ["térképészet", "MGRS"]},
                {"id": 13, "front": "Mit jelent a GEOREF rendszer?", "back": "Földrajzi (fokhálózati) koordinátákon alapuló azonosítási rendszer. Felépítése: 15°×15°-os négyzet (2 betű) + 1°×1°-os négyzet (2 betű) + percértékek. Elsősorban légierő alkalmazásokhoz.", "tags": ["térképészet", "GEOREF"]},
                {"id": 14, "front": "Milyen NATO szabványos térképméretarányok vannak?", "back": "1. 1:25 000 - alegységek, részletes tervezés\n2. 1:50 000 - leggyakoribb harcászati térkép\n3. 1:100 000 - hadműveleti tervezés\n4. 1:250 000 - hadászati tervezés\n5. 1:500 000 - légi navigáció\n6. 1:1 000 000 - áttekintő térképek", "tags": ["térképészet", "méretarány"]},
                {"id": 15, "front": "Mi a szintvonal (izohipsza)?", "back": "Az egyenlő tengerszint feletti magasságú pontokat összekötő zárt görbe vonal a térképen. A szintvonalak távolságából a lejtő meredekségére következtethetünk: sűrű vonalak = meredek lejtő.", "tags": ["térképészet", "domborzat"]},
                {"id": 16, "front": "Mi az alapszintköz?", "back": "Két egymást követő alapszintvonal közötti magasságkülönbség. Értéke méretaránytól függ:\n- 1:25 000 → 10 m\n- 1:50 000 → 20 m\n- 1:100 000 → 40 m", "tags": ["térképészet", "domborzat"]},
                {"id": 17, "front": "Mit jelöl a főszintvonal és a segédszintvonal?", "back": "Főszintvonal: ötödik alapszintvonal, vastagabb vonallal jelölve, könnyebb tájékozódást segíti.\nSegédszintvonal: fél alapszintközönként húzott szaggatott vonal, ahol a domborzat enyhébb változásait nem mutatná az alapszintvonal.", "tags": ["térképészet", "domborzat"]},
                {"id": 18, "front": "Mit jelöl a csúcs és a nyeregpont a térképen?", "back": "Csúcs: koncentrikus, zárt szintvonalak, a legbelső a legmagasabb pont körül.\nNyeregpont: két kiemelkedés közötti legmélyebb pont, ahol a szintvonalak 8-as vagy homokóra alakzatot formálnak.", "tags": ["térképészet", "domborzat"]},
                {"id": 19, "front": "Mi a hát- és völgyvonal?", "back": "Hátvonal (gerinc): kiemelkedés legmagasabb vonala, ahol a szintvonalak kidomborodnak a magasabb területek felé.\nVölgyvonal: mélyedés legmélyebb vonala, ahol a szintvonalak az alacsonyabb területek felé domborodnak.", "tags": ["térképészet", "domborzat"]},
                {"id": 20, "front": "Milyen tájolók rendszeresítettek a Magyar Honvédségben?", "back": "1. 39/49 M típusú tükrös-szelencés tájoló (Bézárd típus) - 6000 vonás beosztás\n2. Cammenga 3H lencsés tájoló - 6400 vonás (NATO szabvány)", "tags": ["tájékozódás", "tájoló"]},
                {"id": 21, "front": "Mi a különbség a 6000 és 6400 vonás beosztás között?", "back": "6000 vonás: a teljes kör 6000 részre osztása, 1 vonás ≈ 1 méter 1 km-re.\n6400 vonás (mil): NATO szabvány, a teljes kör 6400 részre osztása. A Cammenga 3H ezt használja.", "tags": ["tájékozódás", "tájoló"]},
                {"id": 22, "front": "Mi a vonásképlet és mire használható?", "back": "T = S × 1000 / V\n\nT = távolság (méterben)\nS = a tárgy mérete (méterben)\nV = leolvasott vonásérték\n\nTávolságbecslésre és célméretre használható, ha egy adat ismert.", "tags": ["tájékozódás", "vonásképlet"]},
                {"id": 23, "front": "Milyen főbb részeit ismered a Cammenga 3H tájolónak?", "back": "1. Fedél célzóréssel\n2. Irányzószál\n3. Lebegőtárcsa (beosztással)\n4. Rögzített leolvasójel\n5. Nagyító lencse\n6. Vonalzóél\n7. Foszforeszkáló jelek (éjszakai használat)", "tags": ["tájékozódás", "tájoló"]},
                {"id": 24, "front": "Mik a 39/49 M tájoló (Bézárd) főbb részei?", "back": "1. Forgatható szelence (6000 vonás beosztás)\n2. Tükör (mágnestű figyeléséhez)\n3. Irányzófedél és irányzórések\n4. Mágnestű\n5. Vonalzóél méretarány-beosztással\n6. Foszforeszkáló jelek", "tags": ["tájékozódás", "tájoló"]},
                {"id": 25, "front": "Mi az EDF 7×40 távcső és milyen mérőhálózata van?", "back": "Katonai távcső: 7× nagyítás, 40 mm objektív átmérő.\nMérőhálózat: 10 vonás nagy beosztás, 5 vonás kis beosztás.\nA vonásképlettel távolságbecslésre használható.", "tags": ["tájékozódás", "távcső"]},
                {"id": 26, "front": "Mik a fő világtájak azimut értékei (6400 vonás)?", "back": "Észak (N): 0 / 6400 vonás\nKelet (E): 1600 vonás\nDél (S): 3200 vonás\nNyugat (W): 4800 vonás", "tags": ["tájékozódás", "világtáj"]},
                {"id": 27, "front": "Mik a fő világtájak azimut értékei (6000 vonás)?", "back": "Észak (N): 0 / 6000 vonás\nKelet (E): 1500 vonás\nDél (S): 3000 vonás\nNyugat (W): 4500 vonás", "tags": ["tájékozódás", "világtáj"]},
                {"id": 28, "front": "Mi a földrajzi észak (TN - True North)?", "back": "Az adott állásponton áthaladó helyi meridiánnak a Föld északi pólusára mutató ága. A térképeken a keretvonal függőleges része jelöli. Gyakorlatilag egybeesik a Sarkcsillag irányával.", "tags": ["tájékozódás", "észak"]},
                {"id": 29, "front": "Mi a mágneses észak (MN - Magnetic North)?", "back": "Az adott állásponton a mágneses iránytű északi vége által mutatott irány. A helyi mágneses erőtér irányvonalaival esik egybe. Iránya időben és térben változik.", "tags": ["tájékozódás", "észak"]},
                {"id": 30, "front": "Mi a hálózati észak (GN - Grid North)?", "back": "A térkép kilométer-hálózatának függőleges vonalaival egyező irány. Az egyenlítőn és az UTM zóna középmeridiánjánál esik egybe a földrajzi északkal.", "tags": ["tájékozódás", "észak"]},
                {"id": 31, "front": "Mi az azimut?", "back": "Az északi irány és egy adott pontra mutató irány közötti szög, az északi iránytól az óramutató járásával megegyező irányban mérve. Lehet földrajzi (TA), mágneses (MA) vagy hálózati azimut (GA/irányszög).", "tags": ["tájékozódás", "azimut"]},
                {"id": 32, "front": "Mi a mágneses deklináció (MD)?", "back": "A földrajzi észak (TN) és a mágneses észak (MN) közötti szög.\nMD = MN – TN\nPozitív, ha MN keletre tér el TN-től. Értéke időben és térben változik!", "tags": ["tájékozódás", "deklináció"]},
                {"id": 33, "front": "Mi a vetületi meridián konvergencia (GC)?", "back": "A földrajzi észak (TN) és a hálózati észak (GN) közötti szög.\nGC = GN – TN\nÉrtéke függ az álláspont távolságától az UTM zóna középmeridiánjától és az Egyenlítőtől.", "tags": ["tájékozódás", "konvergencia"]},
                {"id": 34, "front": "Mi a mágneses tájékozószög / iránytűeltérés (GMA)?", "back": "A hálózati észak (GN) és a mágneses észak (MN) közötti szög.\nGMA = GC – MD = MA – GA\nA térképről levett irányszögek átszámításához szükséges a terepen használható mágneses azimuttá.", "tags": ["tájékozódás", "GMA"]},
                {"id": 35, "front": "Hogyan határozható meg az északi irány a Napból analóg órával?", "back": "1. Vízszintesen tartott órát fordítsd úgy, hogy a kismutató a Nap irányába mutasson.\n2. Felezd meg a kismutató és a 12 óra (nyáron 1 óra) közötti szöget.\n3. A szögfelező a Nap irányába meghosszabbítva délre mutat, ellentétes irányban északra.", "tags": ["tájékozódás", "világtáj"]},
                {"id": 36, "front": "Hogyan határozható meg az északi irány a Sarkcsillag alapján?", "back": "1. Keresd meg a Göncölszekér 7 csillagát.\n2. A szekér két hátsó csillagát kösd össze és hosszabbítsd meg felfelé ~5×-ösére.\n3. A kapott pont közelében van a Sarkcsillag (Polaris).\n4. A Sarkcsillag függőleges síkja a földrajzi észak.", "tags": ["tájékozódás", "világtáj"]},
                {"id": 37, "front": "Mik a természeti jelenségek alapján történő világtáj-meghatározás módszerei?", "back": "- Fák lombja délen dúsabb, északon ritkább\n- Fák kérge északon vastagabb, durvább\n- Mohás kérgű fák és sziklák észak felé néznek\n- Kivágott fák évgyűrűi északon sűrűbbek\n- Hangyabolyok déli oldala enyhébb lejtésű", "tags": ["tájékozódás", "természet"]},
                {"id": 38, "front": "Mik a térkép tájolásának lépései tájolóval?", "back": "1. Határozd meg a mágneses deklináció értékét.\n2. Helyezd a tájolót a térképre, irányélét a keretvonalhoz igazítva.\n3. Forgasd a térképet, amíg a tájoló a korrigált értéket nem mutatja.\n\nA deklináció értékét a 6400-ból (lencsés tájoló) ki kell vonni.", "tags": ["tájékozódás", "térkép"]},
                {"id": 39, "front": "Hogyan tájolható a térkép vonalas tereptárgy alapján?", "back": "1. Azonosítsd a terepen és a térképen ugyanazt a vonalas tereptárgyat (út, csatorna).\n2. Helyezz vonalzót a térképi jelre.\n3. Forgasd a térképet, amíg a terepi és térképi irány nem egyezik.\n4. Ellenőrizd egy oldalirányú tereptárggyal.", "tags": ["tájékozódás", "térkép"]},
                {"id": 40, "front": "Hogyan határozható meg az álláspont azonosítással?", "back": "Ha álláspontunk közvetlenül egy térképen ábrázolt tereptárgyon vagy annak közelében van (pl. útkereszteződés, híd), azt egyszerűen beazonosítjuk a tájolt térképen. Ellenőrizzük közelítő iránymérésekkel a környező tereptárgyakra.", "tags": ["tájékozódás", "álláspont"]},
                {"id": 41, "front": "Mi az oldalmetszés módszere?", "back": "Álláspont meghatározása, ha egy azonosított vonalas tereptárgyon állunk:\n1. Azonosítsuk a vonalas tereptárgyat a térképen.\n2. Válasszunk egy oldalt fekvő, azonosítható tereptárgyat.\n3. Irányozzuk meg a tereptárgyat és szerkesszük fel az irányt.\n4. A metszéspont az álláspont.", "tags": ["tájékozódás", "álláspont"]},
                {"id": 42, "front": "Mi a hátrametszés módszere?", "back": "Álláspont meghatározása távolabbi tereptárgyak segítségével:\n1. Válasszunk ki 3 jól azonosítható, távoli tereptárgyat.\n2. Mérjük meg mindegyik mágneses azimutját.\n3. Számítsuk át irányszöggé és szerkesszük fel.\n4. A három irány metszéspontja az álláspont.", "tags": ["tájékozódás", "álláspont"]},
                {"id": 43, "front": "Mekkora hibaháromszög fogadható el hátrametszésnél?", "back": "Ha a hibaháromszög bármely oldalának nagysága nagyobb 2 mm-nél (térképen), a hátrametszést meg kell ismételni. Kisebb hibaháromszögnél a súlypont elfogadható álláspontként.", "tags": ["tájékozódás", "álláspont"]},
                {"id": 44, "front": "Mi az oleátás hátrametszés?", "back": "Gyors módszer átlátszó papírral:\n1. Oleátára szúrd le az álláspont előzetes helyét.\n2. Vonalzóval irányozd meg a 3 tereptárgyat és húzz vonalakat.\n3. Helyezd az oleátát a térképre úgy, hogy mindhárom vonal a saját jelén haladjon át.\n4. Szúrd át az álláspont jelét a térképre.", "tags": ["tájékozódás", "álláspont"]},
                {"id": 45, "front": "Mi az előremetszés módszere?", "back": "Célpont helyének meghatározása két ismert álláspontból:\n1. Az első álláspontból mérj mágneses azimutot a célpontra.\n2. Szerkeszd fel a térképre.\n3. Válts álláspontot.\n4. Ismételd meg a mérést és szerkesztést.\n5. A metszéspont a célpont helye.", "tags": ["tájékozódás", "célpont"]},
                {"id": 46, "front": "Mi a GPS (Global Positioning System)?", "back": "Globális helymeghatározó rendszer. Eredetileg: NAVSTAR (Navigation Satellite Timing And Ranging System). Műholdas navigációs rendszer, amely a Föld bármely pontján lehetővé teszi a pozíció meghatározását.", "tags": ["GPS", "alapfogalom"]},
                {"id": 47, "front": "Milyen szegmensekből áll a GPS rendszer?", "back": "1. Műholdas szegmens: Föld körüli pályán keringő navigációs műholdak\n2. Vezérlő/kontroll szegmens: földi követőállomások\n3. Felhasználói szegmens: GPS vevők és alkalmazások", "tags": ["GPS", "felépítés"]},
                {"id": 48, "front": "Hány GPS műhold kell a pontos helymeghatározáshoz?", "back": "Minimum 4 műhold a pontos 3D helymeghatározáshoz. A negyedik műhold az órahiba kiküszöböléséhez szükséges. 3 műholddal csak 2D (magasság nélküli) pozíció határozható meg.", "tags": ["GPS", "működés"]},
                {"id": 49, "front": "Milyen magasságban keringenek a NAVSTAR GPS műholdak?", "back": "20 200 km magasságban, 6 orbitális pályán. A műholdak száma 24-nél több az üzemelési megbízhatóság érdekében.", "tags": ["GPS", "műholdak"]},
                {"id": 50, "front": "Mi a GPS helymeghatározás elve?", "back": "Kódkorrelációs eljárás: a műhold és a vevő azonos időben azonos kódsorozatot állít elő. A beérkező jel késéséből számítható a távolság. Térbeli ívmetszéssel (több műhold távolsága alapján) határozható meg a pozíció.", "tags": ["GPS", "működés"]},
                {"id": 51, "front": "Mi okoz hibát a GPS helymeghatározásban?", "back": "1. A műholdak atomórái és a vevő kvarcórája közötti eltérés\n2. Ionoszféra okozta jelkésés\n3. Műholdak rossz geometriai elhelyezkedése (konstelláció)\n4. Többutas terjedés (visszaverődés)\n5. 10-20 méteres koordináta-pontosság várható", "tags": ["GPS", "pontosság"]},
                {"id": 52, "front": "Milyen más globális műholdas navigációs rendszerek léteznek?", "back": "1. GLONASS (orosz)\n2. Galileo (európai, polgári kezdeményezés)\n3. BeiDou (kínai)", "tags": ["GPS", "rendszerek"]},
                {"id": 53, "front": "Mire használható a GPS katonai alkalmazásokban?", "back": "1. Helymeghatározási feladatok\n2. Jármű- és flottanavigáció\n3. Fegyverirányítás (precíziós bombák, manőverező rakéták)\n4. Roboteszközök irányítása (UAV-ok)\n5. Időszinkronizáció", "tags": ["GPS", "alkalmazás"]},
                {"id": 54, "front": "Mi a légi fényképek előnye a térképpel szemben?", "back": "1. Frissebb terepi állapotok megjelenítése\n2. Fénykép párok használatával térbeli kép előállítható\n3. Részletesebb lehet mint a térkép\n4. Terep valósághű képe", "tags": ["térképészet", "légi fénykép"]},
                {"id": 55, "front": "Mik a térképi koordinátarendszerek fő típusai?", "back": "1. Földrajzi koordinátarendszer (szélesség, hosszúság fokban)\n2. Vetületi koordinátarendszer (UTM, Gauss-Krüger - méterben)\n3. Keresőhálózati rendszerek (MGRS, GEOREF)", "tags": ["térképészet", "koordináták"]},
                {"id": 56, "front": "Mik a topográfiai térkép fő elemei?", "back": "1. Térképkeret (belső és külső)\n2. Térképmező (ábrázolt terület)\n3. Jelmagyarázat\n4. Méretarány és vonalmérték\n5. Szelvényelnevezés\n6. Északi irányok diagramja\n7. Kiadási és egyéb adatok", "tags": ["térképészet", "térkép"]},
                {"id": 57, "front": "Mit jelent az 1:50 000 méretarány?", "back": "A térképen 1 cm a valóságban 50 000 cm = 500 m. A leggyakrabban használt harcászati térképméretarány. A térképen 2 cm = 1 km a terepen.", "tags": ["térképészet", "méretarány"]},
                {"id": 58, "front": "Hogyan történik a térkép szelvényezése?", "back": "A térképeket szabványos méretű szelvényekre osztják. A szelvények elnevezése tartalmazza a földrajzi azonosítót és a méretarányt. Szomszédos szelvények összeilleszthetők.", "tags": ["térképészet", "szelvény"]},
                {"id": 59, "front": "Mi a tájékozódási pont kijelölésének szempontja?", "back": "1. Környezetétől jól elütő, szembetűnő\n2. Több irányból jól látható\n3. Állandó jellegű (a művelet időtartamára megmarad)\n4. A térképen is azonosítható", "tags": ["tájékozódás", "tájékozódási pont"]},
                {"id": 60, "front": "Mi a John Harrison kronométer jelentősége?", "back": "1759-ben alkotta meg. Lehetővé tette a földrajzi hosszúság pontos meghatározását tengeren. A kikötő helyi idejét mutatta, amiből a Nap delelésekor a hosszúságkülönbség számítható.", "tags": ["GPS", "történelem"]},
                {"id": 61, "front": "Mit jelent a JDAM rövidítés?", "back": "Joint Direct Attack Munition - GPS-vezérlésű precíziós bomba. Előnye, hogy időjárástól és napszaktól kevésbé függ mint más vezérlési módok.", "tags": ["GPS", "fegyverirányítás"]},
                {"id": 62, "front": "Hogyan használható a Hold világtáj meghatározásra?", "back": "Telihold: este keleten, éjfélkor délen, reggel nyugaton.\nElső negyed (D alakú): délben keleten, este délen, éjfélkor nyugaton.\nUtolsó negyed (C alakú): éjfélkor keleten, reggel délen, délben nyugaton.", "tags": ["tájékozódás", "Hold"]},
                {"id": 63, "front": "Mi a tereplépcső?", "back": "Jellegzetes domborzati forma: a terep hirtelen szintkülönbsége, ahol a szintvonalak sűrűsödnek, majd hirtelen ritkulnak. Katonai szempontból fontos: védőállás, megfigyelőpont.", "tags": ["tereptan", "domborzat"]},
                {"id": 64, "front": "Milyen információkat tartalmaz a térképkeret?", "back": "1. Szelvény neve és száma\n2. Kiadás dátuma\n3. Méretarány és vonalmérték\n4. Szomszédos szelvények\n5. Északi irányok diagramja\n6. Mágneses deklináció és éves változása\n7. Koordinátarendszer adatai", "tags": ["térképészet", "térkép"]},
                {"id": 65, "front": "Mi az azimutmenet?", "back": "Navigációs módszer előre meghatározott azimutok és távolságok alapján. Iránytűvel tűzzük ki az irányt, távolságot becsléssel vagy lépésszámolással mérjük. GPS-sel egyszerűsíthető.", "tags": ["tájékozódás", "navigáció"]},
                {"id": 66, "front": "Milyen jellegzetes domborzati idomokat ismerünk?", "back": "1. Csúcs (kúp, kupola)\n2. Nyeregpont\n3. Hát (gerinc)\n4. Völgy\n5. Teknő\n6. Tereplépcső\n7. Horhos (meredek oldalú bevágás)", "tags": ["tereptan", "domborzat"]},
                {"id": 67, "front": "Mi a jelentősége a kilométer-hálózatnak?", "back": "1. Gyors koordináta-meghatározás\n2. Könnyen azonosítható négyzetek\n3. Távolságmérés egyszerűsítése\n4. Tereptárgyak beazonosítása\n5. Hálózati azimut számításához alapvonal", "tags": ["térképészet", "koordináták"]},
                {"id": 68, "front": "Hogyan becsülhető távolság a vonásképlettel?", "back": "Ha ismerjük egy tárgy valódi méretét (S) és leolvassuk a látószöget vonásban (V), akkor:\nT = S × 1000 / V\n\nPl.: 2 m magas ember, 4 vonás = 2 × 1000 / 4 = 500 m", "tags": ["tájékozódás", "vonásképlet"]},
                {"id": 69, "front": "Miért fontos a műholdak jó geometriai eloszlása?", "back": "Minél közelebb vannak egymáshoz a műholdak az égbolton, annál pontatlanabb az ívmetszés eredménye. Az egyenletes eloszlás (jó konstelláció) növeli a helymeghatározás pontosságát.", "tags": ["GPS", "pontosság"]},
                {"id": 70, "front": "Mi a topográfiai térkép?", "back": "A Föld felszínének szabatos, általános célú térképe, amely a terep elemeit és a rajtuk található mesterséges létesítményeket egyezményes jelekkel, a domborzatot szintvonalakkal ábrázolja.", "tags": ["térképészet", "alapfogalom"]}
            ]
        };

        // SM-2 Algorithm Implementation
        class SM2 {
            static defaultCard() {
                return {
                    easeFactor: 2.5,
                    interval: 0,
                    repetitions: 0,
                    nextReview: Date.now(),
                    lastReview: null
                };
            }

            static calculate(card, quality) {
                // quality: 0-5 (0-1: again, 2: hard, 3: good, 4-5: easy)
                let { easeFactor, interval, repetitions } = card;

                if (quality < 3) {
                    // Failed - reset
                    repetitions = 0;
                    interval = 1;
                } else {
                    // Passed
                    if (repetitions === 0) {
                        interval = 1;
                    } else if (repetitions === 1) {
                        interval = 6;
                    } else {
                        interval = Math.round(interval * easeFactor);
                    }
                    repetitions++;
                }

                // Update ease factor
                easeFactor = Math.max(1.3, easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02)));

                const nextReview = Date.now() + interval * 24 * 60 * 60 * 1000;

                return {
                    easeFactor,
                    interval,
                    repetitions,
                    nextReview,
                    lastReview: Date.now()
                };
            }

            static getNextReviewText(interval) {
                if (interval === 0) return 'Most';
                if (interval === 1) return '1 nap';
                if (interval < 7) return `${interval} nap`;
                if (interval < 30) return `${Math.round(interval / 7)} hét`;
                if (interval < 365) return `${Math.round(interval / 30)} hónap`;
                return `${Math.round(interval / 365)} év`;
            }
        }

        // Main App
        class FlashcardApp {
            constructor() {
                this.cards = [];
                this.currentIndex = 0;
                this.isFlipped = false;
                this.sessionStats = { reviewed: 0, again: 0, hard: 0, good: 0, easy: 0 };
                this.studyQueue = [];
                this.storageKey = 'flashcards_progress';

                this.init();
            }

            async init() {
                await this.loadCards();
                this.loadProgress();
                this.buildStudyQueue();
                this.render();
                this.bindEvents();
            }

            async loadCards() {
                let data = null;

                // Try to load from external flashcards.json first
                try {
                    const response = await fetch('flashcards.json');
                    if (response.ok) {
                        data = await response.json();
                        console.log('Loaded from flashcards.json');
                    }
                } catch (error) {
                    console.log('External JSON not available, using embedded data');
                }

                // Fall back to embedded data
                if (!data) {
                    data = DEFAULT_DATA;
                }

                this.deckInfo = data.deck;
                this.cards = data.cards.map(card => ({
                    ...card,
                    ...SM2.defaultCard(),
                    ...(this.getCardProgress(card.id) || {})
                }));

                document.getElementById('deckInfo').textContent =
                    `${this.deckInfo.name} - ${this.cards.length} kártya`;
            }

            showFileUpload() {
                document.getElementById('app').innerHTML = `
                    <div class="empty-state">
                        <h2>Nincs betölthető kártyacsomag</h2>
                        <p>Helyezz egy flashcards.json fájlt ugyanabba a mappába, vagy tölts fel egyet:</p>
                        <div class="file-input-container">
                            <label class="file-input-label" for="fileInput">
                                JSON fájl feltöltése
                            </label>
                            <input type="file" id="fileInput" accept=".json">
                        </div>
                        <p style="margin-top: 20px; font-size: 0.8rem; color: #666;">
                            A JSON formátum: { "deck": {...}, "cards": [{ "id": 1, "front": "...", "back": "..." }] }
                        </p>
                    </div>
                `;

                document.getElementById('fileInput').addEventListener('change', (e) => {
                    this.handleFileUpload(e);
                });
            }

            handleFileUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        this.deckInfo = data.deck || { name: file.name, description: '' };
                        this.cards = data.cards.map(card => ({
                            ...card,
                            ...SM2.defaultCard(),
                            ...(this.getCardProgress(card.id) || {})
                        }));

                        document.getElementById('deckInfo').textContent =
                            `${this.deckInfo.name} - ${this.cards.length} kártya`;

                        this.buildStudyQueue();
                        this.render();
                    } catch (error) {
                        alert('Hibás JSON formátum!');
                    }
                };
                reader.readAsText(file);
            }

            loadProgress() {
                try {
                    const saved = localStorage.getItem(this.storageKey);
                    if (saved) {
                        this.progress = JSON.parse(saved);
                    } else {
                        this.progress = {};
                    }
                } catch {
                    this.progress = {};
                }
            }

            saveProgress() {
                this.cards.forEach(card => {
                    this.progress[card.id] = {
                        easeFactor: card.easeFactor,
                        interval: card.interval,
                        repetitions: card.repetitions,
                        nextReview: card.nextReview,
                        lastReview: card.lastReview
                    };
                });
                localStorage.setItem(this.storageKey, JSON.stringify(this.progress));
            }

            getCardProgress(cardId) {
                return this.progress ? this.progress[cardId] : null;
            }

            buildStudyQueue() {
                const now = Date.now();

                // Cards due for review
                const dueCards = this.cards.filter(card => card.nextReview <= now);

                // Sort by: new cards first, then by next review date
                dueCards.sort((a, b) => {
                    if (a.repetitions === 0 && b.repetitions > 0) return -1;
                    if (a.repetitions > 0 && b.repetitions === 0) return 1;
                    return a.nextReview - b.nextReview;
                });

                this.studyQueue = dueCards;
                this.currentIndex = 0;
            }

            getStats() {
                const now = Date.now();
                return {
                    new: this.cards.filter(c => c.repetitions === 0).length,
                    learning: this.cards.filter(c => c.repetitions > 0 && c.interval < 7).length,
                    review: this.cards.filter(c => c.interval >= 7 && c.nextReview <= now).length,
                    mastered: this.cards.filter(c => c.interval >= 21).length,
                    due: this.studyQueue.length
                };
            }

            getCurrentCard() {
                return this.studyQueue[this.currentIndex];
            }

            flipCard() {
                this.isFlipped = !this.isFlipped;
                this.render();
            }

            rateCard(quality) {
                const card = this.getCurrentCard();
                if (!card) return;

                const qualityMap = { again: 1, hard: 2, good: 3, easy: 5 };
                const q = qualityMap[quality];

                // Update card with SM-2
                const updated = SM2.calculate(card, q);
                Object.assign(card, updated);

                // Update session stats
                this.sessionStats.reviewed++;
                this.sessionStats[quality]++;

                // Save progress
                this.saveProgress();

                // Move to next card
                this.currentIndex++;
                this.isFlipped = false;

                // Rebuild queue if needed (for "again" cards)
                if (quality === 'again') {
                    // Add back to end of queue
                    this.studyQueue.push(card);
                }

                this.render();
            }

            resetProgress() {
                if (confirm('Biztosan törölni szeretnéd az összes haladási adatot?')) {
                    localStorage.removeItem(this.storageKey);
                    this.progress = {};
                    this.cards.forEach(card => {
                        Object.assign(card, SM2.defaultCard());
                    });
                    this.sessionStats = { reviewed: 0, again: 0, hard: 0, good: 0, easy: 0 };
                    this.buildStudyQueue();
                    this.render();
                }
            }

            getIntervalPreview(quality) {
                const card = this.getCurrentCard();
                if (!card) return '';

                const qualityMap = { again: 1, hard: 2, good: 3, easy: 5 };
                const preview = SM2.calculate({...card}, qualityMap[quality]);
                return SM2.getNextReviewText(preview.interval);
            }

            render() {
                const app = document.getElementById('app');
                const stats = this.getStats();
                const card = this.getCurrentCard();
                const progress = this.currentIndex / Math.max(1, this.studyQueue.length) * 100;

                if (this.cards.length === 0) {
                    return; // File upload screen is shown
                }

                if (!card) {
                    // Session complete
                    app.innerHTML = `
                        <div class="stats-bar">
                            <div class="stat-item new">
                                <div class="stat-value">${stats.new}</div>
                                <div class="stat-label">Új</div>
                            </div>
                            <div class="stat-item learning">
                                <div class="stat-value">${stats.learning}</div>
                                <div class="stat-label">Tanulás</div>
                            </div>
                            <div class="stat-item review">
                                <div class="stat-value">${stats.review}</div>
                                <div class="stat-label">Ismétlés</div>
                            </div>
                            <div class="stat-item mastered">
                                <div class="stat-value">${stats.mastered}</div>
                                <div class="stat-label">Elsajátított</div>
                            </div>
                        </div>

                        <div class="session-complete">
                            <h2>Gratulálok!</h2>
                            <p>Minden esedékes kártyát átnéztél.</p>

                            <div class="session-stats">
                                <div class="session-stat">
                                    <div class="session-stat-value" style="color: #00ff88">${this.sessionStats.reviewed}</div>
                                    <div class="session-stat-label">Átnézett</div>
                                </div>
                                <div class="session-stat">
                                    <div class="session-stat-value" style="color: #27ae60">${this.sessionStats.good + this.sessionStats.easy}</div>
                                    <div class="session-stat-label">Sikeres</div>
                                </div>
                                <div class="session-stat">
                                    <div class="session-stat-value" style="color: #e74c3c">${this.sessionStats.again}</div>
                                    <div class="session-stat-label">Újra</div>
                                </div>
                            </div>

                            <div class="controls">
                                <button class="control-btn" onclick="app.buildStudyQueue(); app.render();">
                                    Frissítés
                                </button>
                                <button class="control-btn" onclick="app.resetProgress()">
                                    Visszaállítás
                                </button>
                            </div>
                        </div>
                    `;
                    return;
                }

                app.innerHTML = `
                    <div class="stats-bar">
                        <div class="stat-item new">
                            <div class="stat-value">${stats.new}</div>
                            <div class="stat-label">Új</div>
                        </div>
                        <div class="stat-item learning">
                            <div class="stat-value">${stats.learning}</div>
                            <div class="stat-label">Tanulás</div>
                        </div>
                        <div class="stat-item review">
                            <div class="stat-value">${stats.due}</div>
                            <div class="stat-label">Esedékes</div>
                        </div>
                        <div class="stat-item mastered">
                            <div class="stat-value">${stats.mastered}</div>
                            <div class="stat-label">Elsajátított</div>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div class="progress-bar" style="width: ${progress}%"></div>
                    </div>

                    <div class="card-container" onclick="app.flipCard()">
                        <div class="flashcard ${this.isFlipped ? 'flipped' : ''}">
                            <div class="card-face card-front">
                                <div class="card-number">${this.currentIndex + 1} / ${this.studyQueue.length}</div>
                                <div class="card-tags">
                                    ${(card.tags || []).map(t => `<span class="tag">${t}</span>`).join('')}
                                </div>
                                ${card.frontImage ? `<img src="${card.frontImage}" class="card-image" alt="">` : ''}
                                <div class="card-content">${card.front}</div>
                                <div class="card-hint">Kattints a megfordításhoz</div>
                            </div>
                            <div class="card-face card-back">
                                <div class="card-number">${this.currentIndex + 1} / ${this.studyQueue.length}</div>
                                ${card.backImage ? `<img src="${card.backImage}" class="card-image" alt="">` : ''}
                                <div class="card-content">${card.back}</div>
                            </div>
                        </div>
                    </div>

                    <div class="rating-buttons ${this.isFlipped ? 'visible' : ''}">
                        <button class="rating-btn again" onclick="event.stopPropagation(); app.rateCard('again')">
                            Újra
                            <span class="next-review">${this.getIntervalPreview('again')}</span>
                        </button>
                        <button class="rating-btn hard" onclick="event.stopPropagation(); app.rateCard('hard')">
                            Nehéz
                            <span class="next-review">${this.getIntervalPreview('hard')}</span>
                        </button>
                        <button class="rating-btn good" onclick="event.stopPropagation(); app.rateCard('good')">
                            Jó
                            <span class="next-review">${this.getIntervalPreview('good')}</span>
                        </button>
                        <button class="rating-btn easy" onclick="event.stopPropagation(); app.rateCard('easy')">
                            Könnyű
                            <span class="next-review">${this.getIntervalPreview('easy')}</span>
                        </button>
                    </div>

                    <div class="controls">
                        <button class="control-btn" onclick="app.resetProgress()">
                            Visszaállítás
                        </button>
                    </div>
                `;
            }

            bindEvents() {
                document.addEventListener('keydown', (e) => {
                    if (e.target.tagName === 'INPUT') return;

                    switch(e.key) {
                        case ' ':
                            e.preventDefault();
                            this.flipCard();
                            break;
                        case '1':
                            if (this.isFlipped) this.rateCard('again');
                            break;
                        case '2':
                            if (this.isFlipped) this.rateCard('hard');
                            break;
                        case '3':
                            if (this.isFlipped) this.rateCard('good');
                            break;
                        case '4':
                            if (this.isFlipped) this.rateCard('easy');
                            break;
                        case 'r':
                        case 'R':
                            this.resetProgress();
                            break;
                    }
                });

                // File input handler for loading custom JSON
                document.getElementById('fileInput').addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            this.deckInfo = data.deck || { name: file.name, description: '' };
                            this.cards = data.cards.map(card => ({
                                ...card,
                                ...SM2.defaultCard()
                            }));

                            document.getElementById('deckInfo').textContent =
                                `${this.deckInfo.name} - ${this.cards.length} kártya`;

                            this.sessionStats = { reviewed: 0, again: 0, hard: 0, good: 0, easy: 0 };
                            this.buildStudyQueue();
                            this.render();
                        } catch (error) {
                            alert('Hibás JSON formátum! Ellenőrizd a fájlt.');
                        }
                    };
                    reader.readAsText(file);
                    e.target.value = ''; // Reset input
                });
            }
        }

        // Initialize app
        const app = new FlashcardApp();
    </script>
</body>
</html>
